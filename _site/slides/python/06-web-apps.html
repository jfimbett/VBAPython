<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-a6e161b2431e1f94a14e0f5d32135a3c.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <meta name="author" content="Juan F. Imbet">
  <title>Introduction to VBA and Python ‚Äì Python Session 6 ‚Äî Flask and Streamlit</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="../../styles.css">
  <link rel="stylesheet" href="styles.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <!-- Minimal TikZJax + MathJax loader for Quarto/Reveal.js -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tikzjax@0.1.6/tikzjax.css">
  <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tikzjax@0.1.6/tikzjax.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Python Session 6 ‚Äî Flask and Streamlit</h1>
  <p class="subtitle">From scripts to simple apps</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Juan F. Imbet 
</div>
        <p class="quarto-title-affiliation">
            Paris Dauphine University-PSL
          </p>
    </div>
</div>

</section>
<section id="two-paths-to-apps" class="slide level2">
<h2>Two paths to apps</h2>
<ul>
<li><strong>Flask</strong> (micro web framework)
<ul>
<li>Full control over <strong>HTTP</strong>, URLs, templates, sessions, cookies</li>
<li>Perfect for <strong>APIs</strong>, custom dashboards, teaching core web concepts</li>
<li>Typical stack: Flask + Jinja2 + SQLAlchemy + Bootstrap</li>
</ul></li>
<li><strong>Streamlit</strong> (data app framework)
<ul>
<li>Focus on <strong>data + UI</strong> with minimal web boilerplate</li>
<li>Perfect for <strong>quick prototypes</strong>, EDA dashboards, teaching ML results</li>
<li>You think in <strong>Python scripts</strong>, Streamlit turns them into web apps</li>
</ul></li>
</ul>
</section>
<section id="what-is-wsgi" class="slide level2">
<h2>What is WSGI?</h2>
<ul>
<li><strong>WSGI</strong> = Web Server Gateway Interface
<ul>
<li>Standard interface between Python web apps and web servers</li>
<li>Allows your Flask app to communicate with web servers (Apache, Nginx, etc.)</li>
</ul></li>
<li>Think of it as a <strong>translator</strong>:
<ul>
<li>Web server receives HTTP request ‚Üí passes to WSGI ‚Üí your Flask app processes ‚Üí returns response</li>
</ul></li>
<li>For development:
<ul>
<li>Flask has built-in server (<code>app.run()</code>)</li>
</ul></li>
<li>For production:
<ul>
<li>Use production-grade WSGI servers like <strong>gunicorn</strong> or <strong>uWSGI</strong></li>
<li>They handle multiple requests concurrently and are more robust</li>
</ul></li>
</ul>
</section>
<section id="flask-hello-app" class="slide level2">
<h2>Flask: hello app</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">from</span> flask <span class="im">import</span> Flask</span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)  <span class="co"># Flask app object</span></span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a><span class="at">@app.get</span>(<span class="st">"/"</span>)</span>
<span id="cb1-6"><a></a><span class="kw">def</span> home():</span>
<span id="cb1-7"><a></a>    <span class="cf">return</span> <span class="st">"Hello, Flask! üêç"</span></span>
<span id="cb1-8"><a></a></span>
<span id="cb1-9"><a></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb1-10"><a></a>    <span class="co"># For local development only (not production)</span></span>
<span id="cb1-11"><a></a>    app.run(debug<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><p>Save as <code>app.py</code></p></li>
<li><p>Run with Flask CLI (recommended):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a></a><span class="bu">export</span> <span class="va">FLASK_APP</span><span class="op">=</span>app</span>
<span id="cb2-2"><a></a><span class="bu">export</span> <span class="va">FLASK_ENV</span><span class="op">=</span>development  <span class="co"># enables debug mode</span></span>
<span id="cb2-3"><a></a><span class="ex">flask</span> run</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Visit: <code>http://127.0.0.1:5000/</code></p></li>
</ul>
</section>
<section id="flask-routes-and-params" class="slide level2">
<h2>Flask: routes and params</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">from</span> flask <span class="im">import</span> request</span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a><span class="at">@app.get</span>(<span class="st">"/greet/&lt;name&gt;"</span>)</span>
<span id="cb3-4"><a></a><span class="kw">def</span> greet(name):</span>
<span id="cb3-5"><a></a>    excited <span class="op">=</span> request.args.get(<span class="st">"excited"</span>, <span class="st">"0"</span>) <span class="op">==</span> <span class="st">"1"</span></span>
<span id="cb3-6"><a></a>    suffix <span class="op">=</span> <span class="st">"!!!"</span> <span class="cf">if</span> excited <span class="cf">else</span> <span class="st">"."</span></span>
<span id="cb3-7"><a></a>    <span class="cf">return</span> <span class="ss">f"Hi </span><span class="sc">{</span>name<span class="sc">}{</span>suffix<span class="sc">}</span><span class="ss">"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong>Path parameter</strong>: <code>&lt;name&gt;</code> appears in the URL, becomes a function argument</li>
<li><strong>Query parameter</strong>: <code>?excited=1</code> read via <code>request.args</code></li>
<li>Example URL:
<ul>
<li><code>http://localhost:5000/greet/Ana</code></li>
<li><code>http://localhost:5000/greet/Ana?excited=1</code></li>
</ul></li>
<li>You can restrict types: <code>/user/&lt;int:user_id&gt;</code>, <code>/price/&lt;float:x&gt;</code></li>
</ul>
</section>
<section id="flask-templates-jinja2" class="slide level2">
<h2>Flask: templates (Jinja2)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="im">from</span> flask <span class="im">import</span> render_template</span>
<span id="cb4-2"><a></a></span>
<span id="cb4-3"><a></a><span class="at">@app.get</span>(<span class="st">"/user/&lt;name&gt;"</span>)</span>
<span id="cb4-4"><a></a><span class="kw">def</span> user_profile(name):</span>
<span id="cb4-5"><a></a>    hobbies <span class="op">=</span> [<span class="st">"coding"</span>, <span class="st">"running"</span>, <span class="st">"music"</span>]</span>
<span id="cb4-6"><a></a>    <span class="cf">return</span> render_template(<span class="st">"user.html"</span>, name<span class="op">=</span>name, hobbies<span class="op">=</span>hobbies)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong><code>templates/user.html</code></strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource html number-lines code-with-copy"><code class="sourceCode html"><span id="cb5-1"><a></a><span class="dt">&lt;!doctype</span> html<span class="dt">&gt;</span></span>
<span id="cb5-2"><a></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">"en"</span><span class="dt">&gt;</span></span>
<span id="cb5-3"><a></a>  <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb5-4"><a></a>    <span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Hello {{ name }}!<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb5-5"><a></a>    <span class="dt">&lt;</span><span class="kw">ul</span><span class="dt">&gt;</span></span>
<span id="cb5-6"><a></a>      {% for h in hobbies %}</span>
<span id="cb5-7"><a></a>        <span class="dt">&lt;</span><span class="kw">li</span><span class="dt">&gt;</span>{{ h }}<span class="dt">&lt;/</span><span class="kw">li</span><span class="dt">&gt;</span></span>
<span id="cb5-8"><a></a>      {% endfor %}</span>
<span id="cb5-9"><a></a>    <span class="dt">&lt;/</span><span class="kw">ul</span><span class="dt">&gt;</span></span>
<span id="cb5-10"><a></a>  <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb5-11"><a></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong>Jinja2</strong> = template engine used by Flask</li>
<li><code>{ ... }</code> for variables, <code>{% ... %}</code> for control flow</li>
<li>Goal: <strong>Python = logic</strong>, <strong>Jinja = presentation</strong></li>
</ul>
</section>
<section id="flask-forms-and-json" class="slide level2">
<h2>Flask: forms and JSON</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="im">from</span> flask <span class="im">import</span> request, jsonify, render_template</span>
<span id="cb6-2"><a></a></span>
<span id="cb6-3"><a></a><span class="at">@app.get</span>(<span class="st">"/form"</span>)</span>
<span id="cb6-4"><a></a><span class="kw">def</span> show_form():</span>
<span id="cb6-5"><a></a>    <span class="cf">return</span> render_template(<span class="st">"sum_form.html"</span>)</span>
<span id="cb6-6"><a></a></span>
<span id="cb6-7"><a></a><span class="at">@app.post</span>(<span class="st">"/sum"</span>)</span>
<span id="cb6-8"><a></a><span class="kw">def</span> compute_sum():</span>
<span id="cb6-9"><a></a>    a <span class="op">=</span> <span class="bu">int</span>(request.form[<span class="st">"a"</span>])</span>
<span id="cb6-10"><a></a>    b <span class="op">=</span> <span class="bu">int</span>(request.form[<span class="st">"b"</span>])</span>
<span id="cb6-11"><a></a>    total <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb6-12"><a></a>    <span class="cf">return</span> render_template(<span class="st">"sum_result.html"</span>, total<span class="op">=</span>total)</span>
<span id="cb6-13"><a></a></span>
<span id="cb6-14"><a></a><span class="at">@app.post</span>(<span class="st">"/api/sum"</span>)</span>
<span id="cb6-15"><a></a><span class="kw">def</span> api_sum():</span>
<span id="cb6-16"><a></a>    data <span class="op">=</span> request.get_json()</span>
<span id="cb6-17"><a></a>    a <span class="op">=</span> data[<span class="st">"a"</span>]</span>
<span id="cb6-18"><a></a>    b <span class="op">=</span> data[<span class="st">"b"</span>]</span>
<span id="cb6-19"><a></a>    <span class="cf">return</span> jsonify({<span class="st">"result"</span>: a <span class="op">+</span> b})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>request.form</code> ‚Üí form fields sent via POST (<code>Content-Type: application/x-www-form-urlencoded</code>)</li>
<li><code>request.get_json()</code> / <code>request.json</code> ‚Üí JSON body for APIs</li>
<li><code>jsonify</code> converts dict ‚Üí JSON response with correct headers</li>
</ul>
</section>
<section id="flask-calling-apis-with-requests" class="slide level2">
<h2>Flask: calling APIs with requests</h2>
<p><strong>Server code</strong> (<code>test.py</code>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="at">@app.post</span>(<span class="st">"/api/sum"</span>)</span>
<span id="cb7-2"><a></a><span class="kw">def</span> api_sum():</span>
<span id="cb7-3"><a></a>    data <span class="op">=</span> request.get_json()</span>
<span id="cb7-4"><a></a>    a <span class="op">=</span> data[<span class="st">"a"</span>]</span>
<span id="cb7-5"><a></a>    b <span class="op">=</span> data[<span class="st">"b"</span>]</span>
<span id="cb7-6"><a></a>    <span class="cf">return</span> jsonify({<span class="st">"result"</span>: a <span class="op">+</span> b})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Client code</strong> (<code>api_test.py</code>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="im">import</span> requests</span>
<span id="cb8-2"><a></a></span>
<span id="cb8-3"><a></a>data <span class="op">=</span> {<span class="st">"a"</span>: <span class="dv">5</span>, <span class="st">"b"</span>: <span class="dv">7</span>}</span>
<span id="cb8-4"><a></a></span>
<span id="cb8-5"><a></a>response <span class="op">=</span> requests.post(<span class="st">"http://127.0.0.1:5000/api/sum"</span>, json<span class="op">=</span>data)</span>
<span id="cb8-6"><a></a><span class="bu">print</span>(response.json())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Use <code>requests.post()</code> with <code>json=</code> parameter to send JSON data</li>
<li>Server must use <code>request.get_json()</code> to parse the JSON body</li>
<li>Response is also JSON, parse with <code>response.json()</code></li>
</ul>
</section>
<section id="flask-request-lifecycle" class="slide level2">
<h2>Flask: request lifecycle</h2>
<ul>
<li><strong>Browser ‚Üí HTTP request ‚Üí Web server ‚Üí Flask app ‚Üí view function ‚Üí response</strong></li>
<li>The WSGI layer sits between web server and Flask, handling the protocol translation</li>
<li>Important globals:
<ul>
<li><code>request</code>: current HTTP request (method, headers, body, args‚Ä¶)</li>
<li><code>session</code>: per-user, signed cookie storage</li>
<li><code>g</code>: request-scoped storage (DB connection, current user‚Ä¶)</li>
</ul></li>
<li>Hooks:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a><span class="im">from</span> flask <span class="im">import</span> g, request</span>
<span id="cb9-2"><a></a></span>
<span id="cb9-3"><a></a><span class="at">@app.before_request</span></span>
<span id="cb9-4"><a></a><span class="kw">def</span> before():</span>
<span id="cb9-5"><a></a>    g.request_path <span class="op">=</span> request.path</span>
<span id="cb9-6"><a></a></span>
<span id="cb9-7"><a></a><span class="at">@app.after_request</span></span>
<span id="cb9-8"><a></a><span class="kw">def</span> after(response):</span>
<span id="cb9-9"><a></a>    <span class="co"># e.g. add custom header</span></span>
<span id="cb9-10"><a></a>    response.headers[<span class="st">"X-App-Name"</span>] <span class="op">=</span> <span class="st">"Intro-Flask"</span></span>
<span id="cb9-11"><a></a>    <span class="cf">return</span> response</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Think of it as a <strong>pipeline</strong> where you can plug in logic before/after views</li>
</ul>
</section>
<section id="flask-url_for-and-redirects" class="slide level2">
<h2>Flask: <code>url_for</code> and redirects</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="im">from</span> flask <span class="im">import</span> url_for, redirect</span>
<span id="cb10-2"><a></a></span>
<span id="cb10-3"><a></a><span class="at">@app.get</span>(<span class="st">"/"</span>)</span>
<span id="cb10-4"><a></a><span class="kw">def</span> index():</span>
<span id="cb10-5"><a></a>    <span class="co"># Generate URLs by function name (safer than hard-coding strings)</span></span>
<span id="cb10-6"><a></a>    <span class="cf">return</span> <span class="ss">f'&lt;a href="</span><span class="sc">{</span>url_for(<span class="st">"dashboard"</span>)<span class="sc">}</span><span class="ss">"&gt;Go to dashboard&lt;/a&gt;'</span></span>
<span id="cb10-7"><a></a></span>
<span id="cb10-8"><a></a><span class="at">@app.get</span>(<span class="st">"/dashboard"</span>)</span>
<span id="cb10-9"><a></a><span class="kw">def</span> dashboard():</span>
<span id="cb10-10"><a></a>    <span class="cf">return</span> <span class="st">"Dashboard"</span></span>
<span id="cb10-11"><a></a></span>
<span id="cb10-12"><a></a><span class="at">@app.get</span>(<span class="st">"/old-dashboard"</span>)</span>
<span id="cb10-13"><a></a><span class="kw">def</span> old_dashboard():</span>
<span id="cb10-14"><a></a>    <span class="co"># Permanent redirect to new endpoint</span></span>
<span id="cb10-15"><a></a>    <span class="cf">return</span> redirect(url_for(<span class="st">"dashboard"</span>), code<span class="op">=</span><span class="dv">301</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>url_for("dashboard")</code> builds <code>/dashboard</code>
<ul>
<li>Robust when you later change URLs / add prefixes / blueprints</li>
</ul></li>
<li><code>redirect()</code> sends HTTP 302/301 to the browser</li>
</ul>
</section>
<section id="flask-configuration-environments" class="slide level2">
<h2>Flask: configuration &amp; environments</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a><span class="im">import</span> os</span>
<span id="cb11-2"><a></a></span>
<span id="cb11-3"><a></a><span class="kw">class</span> Config:</span>
<span id="cb11-4"><a></a>    SECRET_KEY <span class="op">=</span> os.environ.get(<span class="st">"SECRET_KEY"</span>, <span class="st">"dev-key"</span>)</span>
<span id="cb11-5"><a></a>    DEBUG <span class="op">=</span> <span class="va">False</span></span>
<span id="cb11-6"><a></a></span>
<span id="cb11-7"><a></a><span class="kw">class</span> DevConfig(Config):</span>
<span id="cb11-8"><a></a>    DEBUG <span class="op">=</span> <span class="va">True</span></span>
<span id="cb11-9"><a></a></span>
<span id="cb11-10"><a></a><span class="kw">class</span> ProdConfig(Config):</span>
<span id="cb11-11"><a></a>    DEBUG <span class="op">=</span> <span class="va">False</span></span>
<span id="cb11-12"><a></a></span>
<span id="cb11-13"><a></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb11-14"><a></a>app.config.from_object(DevConfig)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Access anywhere: <code>app.config["SECRET_KEY"]</code></li>
<li>Typical pattern:
<ul>
<li><strong>Config class</strong> (Dev / Prod / Test)</li>
<li>Read secrets from <strong>environment variables</strong> (never hard-code passwords)</li>
</ul></li>
</ul>
</section>
<section id="flask-application-factory-pattern" class="slide level2">
<h2>Flask: application factory pattern</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a><span class="kw">def</span> create_app(config_object<span class="op">=</span>DevConfig):</span>
<span id="cb12-2"><a></a>    app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb12-3"><a></a>    app.config.from_object(config_object)</span>
<span id="cb12-4"><a></a>    <span class="co"># register blueprints, extensions‚Ä¶</span></span>
<span id="cb12-5"><a></a>    <span class="cf">return</span> app</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Benefits:
<ul>
<li>Create multiple app instances with different configs</li>
<li>Easier testing (create test app with test config)</li>
<li>Better organized for larger applications</li>
</ul></li>
<li>Usage:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a><span class="co"># For development</span></span>
<span id="cb13-2"><a></a>app <span class="op">=</span> create_app(DevConfig)</span>
<span id="cb13-3"><a></a></span>
<span id="cb13-4"><a></a><span class="co"># For production</span></span>
<span id="cb13-5"><a></a>app <span class="op">=</span> create_app(ProdConfig)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="streamlit-hello-app" class="slide level2">
<h2>Streamlit: hello app</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb14-2"><a></a></span>
<span id="cb14-3"><a></a>st.title(<span class="st">"Hello Streamlit üëã"</span>)</span>
<span id="cb14-4"><a></a></span>
<span id="cb14-5"><a></a>name <span class="op">=</span> st.text_input(<span class="st">"Name"</span>, value<span class="op">=</span><span class="st">"Juan"</span>)</span>
<span id="cb14-6"><a></a>age <span class="op">=</span> st.slider(<span class="st">"Age"</span>, min_value<span class="op">=</span><span class="dv">0</span>, max_value<span class="op">=</span><span class="dv">100</span>, value<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb14-7"><a></a></span>
<span id="cb14-8"><a></a><span class="cf">if</span> name:</span>
<span id="cb14-9"><a></a>    st.write(<span class="ss">f"Hi </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">, you are </span><span class="sc">{</span>age<span class="sc">}</span><span class="ss"> years old."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Run: <code>streamlit run app.py</code></li>
<li>Streamlit watches your code ‚Üí <strong>auto-reload on save</strong></li>
<li>Everything runs <strong>top-to-bottom</strong> on each interaction</li>
</ul>
</section>
<section id="streamlit-widgets" class="slide level2">
<h2>Streamlit: widgets</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb15-2"><a></a></span>
<span id="cb15-3"><a></a>st.sidebar.header(<span class="st">"Controls"</span>)</span>
<span id="cb15-4"><a></a></span>
<span id="cb15-5"><a></a>option <span class="op">=</span> st.selectbox(<span class="st">"Model"</span>, [<span class="st">"Logit"</span>, <span class="st">"Random Forest"</span>, <span class="st">"XGBoost"</span>])</span>
<span id="cb15-6"><a></a>threshold <span class="op">=</span> st.slider(<span class="st">"Default threshold"</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-7"><a></a>upload <span class="op">=</span> st.file_uploader(<span class="st">"Upload CSV"</span>, <span class="bu">type</span><span class="op">=</span>[<span class="st">"csv"</span>])</span>
<span id="cb15-8"><a></a></span>
<span id="cb15-9"><a></a><span class="cf">if</span> upload:</span>
<span id="cb15-10"><a></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-11"><a></a>    df <span class="op">=</span> pd.read_csv(upload)</span>
<span id="cb15-12"><a></a>    st.write(<span class="st">"Preview:"</span>, df.head())</span>
<span id="cb15-13"><a></a></span>
<span id="cb15-14"><a></a>st.write(<span class="st">"Selected model:"</span>, option)</span>
<span id="cb15-15"><a></a>st.write(<span class="st">"Threshold:"</span>, threshold)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Widgets: <code>text_input</code>, <code>selectbox</code>, <code>slider</code>, <code>checkbox</code>, <code>file_uploader</code>, <code>date_input</code>, ‚Ä¶</li>
<li><strong>Immediate feedback</strong>: UI updates after every interaction</li>
</ul>
</section>
<section id="streamlit-caching" class="slide level2">
<h2>Streamlit: caching</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a><span class="im">import</span> time</span>
<span id="cb16-2"><a></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb16-3"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-4"><a></a></span>
<span id="cb16-5"><a></a><span class="at">@st.cache_data</span></span>
<span id="cb16-6"><a></a><span class="kw">def</span> load_data(path):</span>
<span id="cb16-7"><a></a>    time.sleep(<span class="dv">2</span>)  <span class="co"># simulate slow I/O</span></span>
<span id="cb16-8"><a></a>    <span class="cf">return</span> pd.read_csv(path)</span>
<span id="cb16-9"><a></a></span>
<span id="cb16-10"><a></a>df <span class="op">=</span> load_data(<span class="st">"data/big.csv"</span>)</span>
<span id="cb16-11"><a></a>st.write(df.head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>@st.cache_data</code>:
<ul>
<li>Caches <strong>pure functions</strong>: same inputs ‚Üí reuse output</li>
<li>Clears cache when code changes or when you call <code>clear_cache()</code></li>
</ul></li>
<li>Great for: downloading data, feature engineering, slow aggregations</li>
</ul>
</section>
<section id="deploying" class="slide level2">
<h2>Deploying</h2>
<ul>
<li><strong>Flask</strong>
<ul>
<li>Never use <code>app.run()</code> in production (it‚Äôs single-threaded and not secure)</li>
<li>Use a production <strong>WSGI server</strong> (e.g.&nbsp;<code>gunicorn</code> or <code>uWSGI</code>)</li>
<li>Typical command: <code>gunicorn app:app --workers 4</code></li>
<li>Put behind <strong>reverse proxy</strong> (Nginx/Apache) for HTTPS, load-balancing</li>
</ul></li>
<li><strong>Streamlit</strong>
<ul>
<li>Streamlit Cloud (hosted)</li>
<li>Or containerize (<code>Dockerfile</code>) and deploy to any PaaS / VM</li>
</ul></li>
<li>Common to both:
<ul>
<li>Use <strong>environment variables</strong> for secrets</li>
<li>Ensure <strong>requirements.txt</strong> / <code>pyproject.toml</code> is complete</li>
</ul></li>
</ul>
</section>
<section id="security-basics" class="slide level2">
<h2>Security basics</h2>
<ul>
<li><strong>Never trust user input</strong>
<ul>
<li>Validate types, ranges, allowed values</li>
<li>Use libraries (WTForms, Marshmallow, Pydantic‚Ä¶) instead of doing everything by hand</li>
</ul></li>
<li><strong>Escaping &amp; XSS</strong>
<ul>
<li>Jinja2 auto-escapes by default ‚Üí do not mark data as safe unless you are sure</li>
</ul></li>
<li><strong>CSRF</strong>
<ul>
<li>Protect POST forms (Flask-WTF / your own CSRF tokens)</li>
</ul></li>
<li><strong>Secrets</strong>
<ul>
<li>Store in <strong>env vars</strong> or secret managers, not in Git</li>
<li><code>SECRET_KEY</code>, DB passwords, API keys, OAuth tokens‚Ä¶</li>
</ul></li>
<li><strong>HTTPS</strong>
<ul>
<li>In production, enforce HTTPS, secure cookies, and strong session keys</li>
</ul></li>
</ul>
</section>
<section id="flask-project-structure" class="slide level2">
<h2>Flask project structure</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode numberSource text number-lines code-with-copy"><code class="sourceCode"><span id="cb17-1"><a></a>myapp/</span>
<span id="cb17-2"><a></a>    app.py                 # or __init__.py if using factory pattern</span>
<span id="cb17-3"><a></a>    config.py              # config classes (Dev, Prod, Test)</span>
<span id="cb17-4"><a></a>    templates/</span>
<span id="cb17-5"><a></a>        base.html</span>
<span id="cb17-6"><a></a>        index.html</span>
<span id="cb17-7"><a></a>        dashboard.html</span>
<span id="cb17-8"><a></a>    static/</span>
<span id="cb17-9"><a></a>        css/</span>
<span id="cb17-10"><a></a>        js/</span>
<span id="cb17-11"><a></a>        images/</span>
<span id="cb17-12"><a></a>    blueprints/</span>
<span id="cb17-13"><a></a>        __init__.py</span>
<span id="cb17-14"><a></a>        auth/</span>
<span id="cb17-15"><a></a>            __init__.py</span>
<span id="cb17-16"><a></a>            routes.py</span>
<span id="cb17-17"><a></a>        api/</span>
<span id="cb17-18"><a></a>            __init__.py</span>
<span id="cb17-19"><a></a>            routes.py</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Start simple (<code>app.py</code>) then <strong>refactor</strong> to a package + blueprints as app grows</li>
<li>Separation of concerns:
<ul>
<li>views (routes) / templates / static assets / configuration</li>
</ul></li>
</ul>
</section>
<section id="static-files" class="slide level2">
<h2>Static files</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a><span class="im">from</span> flask <span class="im">import</span> url_for</span>
<span id="cb18-2"><a></a></span>
<span id="cb18-3"><a></a><span class="at">@app.get</span>(<span class="st">"/profile"</span>)</span>
<span id="cb18-4"><a></a><span class="kw">def</span> profile():</span>
<span id="cb18-5"><a></a>    css_url <span class="op">=</span> url_for(<span class="st">"static"</span>, filename<span class="op">=</span><span class="st">"css/app.css"</span>)</span>
<span id="cb18-6"><a></a>    <span class="cf">return</span> <span class="ss">f"""</span></span>
<span id="cb18-7"><a></a><span class="ss">    &lt;html&gt;</span></span>
<span id="cb18-8"><a></a><span class="ss">      &lt;head&gt;&lt;link rel="stylesheet" href="</span><span class="sc">{</span>css_url<span class="sc">}</span><span class="ss">"&gt;&lt;/head&gt;</span></span>
<span id="cb18-9"><a></a><span class="ss">      &lt;body&gt;&lt;h1&gt;Profile page&lt;/h1&gt;&lt;/body&gt;</span></span>
<span id="cb18-10"><a></a><span class="ss">    &lt;/html&gt;</span></span>
<span id="cb18-11"><a></a><span class="ss">    """</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Put static assets under <code>static/</code> (default):
<ul>
<li><code>static/css/app.css</code></li>
<li><code>static/js/app.js</code></li>
<li><code>static/img/logo.png</code></li>
</ul></li>
<li>Use <code>url_for("static", filename="...")</code> instead of hard-coded <code>/static/...</code>
<ul>
<li>Safer when app is mounted under a prefix or served by a proxy</li>
</ul></li>
</ul>
</section>
<section id="error-handling" class="slide level2">
<h2>Error handling</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a><span class="im">from</span> flask <span class="im">import</span> render_template</span>
<span id="cb19-2"><a></a></span>
<span id="cb19-3"><a></a><span class="at">@app.errorhandler</span>(<span class="dv">404</span>)</span>
<span id="cb19-4"><a></a><span class="kw">def</span> not_found(e):</span>
<span id="cb19-5"><a></a>    <span class="cf">return</span> render_template(<span class="st">"404.html"</span>), <span class="dv">404</span></span>
<span id="cb19-6"><a></a></span>
<span id="cb19-7"><a></a><span class="at">@app.errorhandler</span>(<span class="dv">500</span>)</span>
<span id="cb19-8"><a></a><span class="kw">def</span> server_error(e):</span>
<span id="cb19-9"><a></a>    <span class="cf">return</span> render_template(<span class="st">"500.html"</span>), <span class="dv">500</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>You can <code>abort(status_code)</code> to trigger an error:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a><span class="im">from</span> flask <span class="im">import</span> abort</span>
<span id="cb20-2"><a></a></span>
<span id="cb20-3"><a></a><span class="at">@app.get</span>(<span class="st">"/secret"</span>)</span>
<span id="cb20-4"><a></a><span class="kw">def</span> secret():</span>
<span id="cb20-5"><a></a>    abort(<span class="dv">403</span>)  <span class="co"># Forbidden</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Goal: never show users raw tracebacks in production
<ul>
<li>Use custom error pages and proper logging</li>
</ul></li>
</ul>
</section>
<section id="logging" class="slide level2">
<h2>Logging</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a></a><span class="im">import</span> logging</span>
<span id="cb21-2"><a></a></span>
<span id="cb21-3"><a></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb21-4"><a></a></span>
<span id="cb21-5"><a></a><span class="at">@app.before_first_request</span></span>
<span id="cb21-6"><a></a><span class="kw">def</span> startup():</span>
<span id="cb21-7"><a></a>    app.logger.info(<span class="st">"Application started"</span>)</span>
<span id="cb21-8"><a></a></span>
<span id="cb21-9"><a></a><span class="at">@app.get</span>(<span class="st">"/ping"</span>)</span>
<span id="cb21-10"><a></a><span class="kw">def</span> ping():</span>
<span id="cb21-11"><a></a>    app.logger.debug(<span class="st">"Ping endpoint called"</span>)</span>
<span id="cb21-12"><a></a>    <span class="cf">return</span> <span class="st">"pong"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Use log levels: <code>DEBUG</code>, <code>INFO</code>, <code>WARNING</code>, <code>ERROR</code>, <code>CRITICAL</code></li>
<li>In production, send logs to:
<ul>
<li>Files, log aggregation services (ELK stack, Datadog, etc.), or stdout (Docker)</li>
</ul></li>
</ul>
</section>
<section id="sessions-and-cookies" class="slide level2">
<h2>Sessions and cookies</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a></a><span class="im">from</span> flask <span class="im">import</span> session</span>
<span id="cb22-2"><a></a></span>
<span id="cb22-3"><a></a>app.secret_key <span class="op">=</span> <span class="st">"change-me-in-prod"</span>  <span class="co"># or from env</span></span>
<span id="cb22-4"><a></a></span>
<span id="cb22-5"><a></a><span class="at">@app.get</span>(<span class="st">"/login/&lt;user&gt;"</span>)</span>
<span id="cb22-6"><a></a><span class="kw">def</span> login(user):</span>
<span id="cb22-7"><a></a>    session[<span class="st">"user"</span>] <span class="op">=</span> user</span>
<span id="cb22-8"><a></a>    <span class="cf">return</span> <span class="ss">f"Logged in as </span><span class="sc">{</span>user<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb22-9"><a></a></span>
<span id="cb22-10"><a></a><span class="at">@app.get</span>(<span class="st">"/whoami"</span>)</span>
<span id="cb22-11"><a></a><span class="kw">def</span> whoami():</span>
<span id="cb22-12"><a></a>    user <span class="op">=</span> session.get(<span class="st">"user"</span>)</span>
<span id="cb22-13"><a></a>    <span class="cf">return</span> <span class="ss">f"You are </span><span class="sc">{</span>user <span class="kw">or</span> <span class="st">'not logged in'</span><span class="sc">}</span><span class="ss">"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Flask sessions are <strong>signed cookies</strong> (client-side, tamper-proof)</li>
<li>Do <strong>not</strong> store very large or very sensitive data there</li>
<li>You can set <code>session.permanent = True</code> and configure <code>PERMANENT_SESSION_LIFETIME</code></li>
</ul>
</section>
<section id="csrf-and-forms" class="slide level2">
<h2>CSRF and forms</h2>
<ul>
<li>Why CSRF?
<ul>
<li>Attacker tricks user‚Äôs browser into sending a POST to your app</li>
</ul></li>
<li>Typical pattern with Flask-WTF:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a><span class="im">from</span> flask_wtf <span class="im">import</span> FlaskForm</span>
<span id="cb23-2"><a></a><span class="im">from</span> wtforms <span class="im">import</span> StringField, SubmitField</span>
<span id="cb23-3"><a></a><span class="im">from</span> wtforms.validators <span class="im">import</span> DataRequired</span>
<span id="cb23-4"><a></a></span>
<span id="cb23-5"><a></a><span class="kw">class</span> NameForm(FlaskForm):</span>
<span id="cb23-6"><a></a>    name <span class="op">=</span> StringField(<span class="st">"Your name"</span>, validators<span class="op">=</span>[DataRequired()])</span>
<span id="cb23-7"><a></a>    submit <span class="op">=</span> SubmitField(<span class="st">"Submit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a></a><span class="at">@app.route</span>(<span class="st">"/form"</span>, methods<span class="op">=</span>[<span class="st">"GET"</span>, <span class="st">"POST"</span>])</span>
<span id="cb24-2"><a></a><span class="kw">def</span> form():</span>
<span id="cb24-3"><a></a>    form <span class="op">=</span> NameForm()</span>
<span id="cb24-4"><a></a>    <span class="cf">if</span> form.validate_on_submit():</span>
<span id="cb24-5"><a></a>        name <span class="op">=</span> form.name.data</span>
<span id="cb24-6"><a></a>        ...</span>
<span id="cb24-7"><a></a>    <span class="cf">return</span> render_template(<span class="st">"form.html"</span>, form<span class="op">=</span>form)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Template must include <code>{ form.csrf_token }</code>:
<ul>
<li>Flask-WTF automatically validates token</li>
</ul></li>
</ul>
</section>
<section id="file-uploads" class="slide level2">
<h2>File uploads</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="im">import</span> os</span>
<span id="cb25-2"><a></a><span class="im">from</span> flask <span class="im">import</span> request, redirect, url_for</span>
<span id="cb25-3"><a></a></span>
<span id="cb25-4"><a></a>UPLOAD_DIR <span class="op">=</span> <span class="st">"uploads"</span></span>
<span id="cb25-5"><a></a>os.makedirs(UPLOAD_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-6"><a></a></span>
<span id="cb25-7"><a></a>ALLOWED_EXTENSIONS <span class="op">=</span> {<span class="st">"csv"</span>, <span class="st">"txt"</span>}</span>
<span id="cb25-8"><a></a></span>
<span id="cb25-9"><a></a><span class="kw">def</span> allowed(filename):</span>
<span id="cb25-10"><a></a>    <span class="cf">return</span> <span class="st">"."</span> <span class="kw">in</span> filename <span class="kw">and</span> <span class="op">\</span></span>
<span id="cb25-11"><a></a>           filename.rsplit(<span class="st">"."</span>, <span class="dv">1</span>)[<span class="dv">1</span>].lower() <span class="kw">in</span> ALLOWED_EXTENSIONS</span>
<span id="cb25-12"><a></a></span>
<span id="cb25-13"><a></a><span class="at">@app.post</span>(<span class="st">"/upload"</span>)</span>
<span id="cb25-14"><a></a><span class="kw">def</span> upload():</span>
<span id="cb25-15"><a></a>    f <span class="op">=</span> request.files[<span class="st">"file"</span>]</span>
<span id="cb25-16"><a></a>    <span class="cf">if</span> f.filename <span class="op">==</span> <span class="st">""</span> <span class="kw">or</span> <span class="kw">not</span> allowed(f.filename):</span>
<span id="cb25-17"><a></a>        <span class="cf">return</span> <span class="st">"Invalid file"</span>, <span class="dv">400</span></span>
<span id="cb25-18"><a></a>    path <span class="op">=</span> os.path.join(UPLOAD_DIR, f.filename)</span>
<span id="cb25-19"><a></a>    f.save(path)</span>
<span id="cb25-20"><a></a>    <span class="cf">return</span> <span class="ss">f"Saved to </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Validate:
<ul>
<li>Filename extension</li>
<li>File size (can use <code>request.content_length</code>)</li>
</ul></li>
<li>Never trust client-side checks only</li>
</ul>
</section>
<section id="streamlit-session-state" class="slide level2">
<h2>Streamlit: session state</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb26-2"><a></a></span>
<span id="cb26-3"><a></a><span class="cf">if</span> <span class="st">"count"</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb26-4"><a></a>    st.session_state.count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-5"><a></a></span>
<span id="cb26-6"><a></a>st.write(<span class="st">"Count:"</span>, st.session_state.count)</span>
<span id="cb26-7"><a></a></span>
<span id="cb26-8"><a></a><span class="cf">if</span> st.button(<span class="st">"Increment"</span>):</span>
<span id="cb26-9"><a></a>    st.session_state.count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-10"><a></a></span>
<span id="cb26-11"><a></a><span class="cf">if</span> st.button(<span class="st">"Reset"</span>):</span>
<span id="cb26-12"><a></a>    st.session_state.count <span class="op">=</span> <span class="dv">0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>st.session_state</code> is similar to Flask <code>session</code>, but kept <strong>server-side</strong></li>
<li>Use it for:
<ul>
<li>Multi-step forms</li>
<li>Wizard-style flows</li>
<li>Remembering user selections</li>
</ul></li>
</ul>
</section>
<section id="streamlit-caching-nuances" class="slide level2">
<h2>Streamlit: caching nuances</h2>
<ul>
<li><code>st.cache_data</code>:
<ul>
<li>For <strong>data</strong>: reading CSVs, heavy computations, feature engineering</li>
<li>Cache key = function code + arguments</li>
</ul></li>
<li><code>st.cache_resource</code>:
<ul>
<li>For <strong>resources</strong>: ML models, DB connections, clients</li>
<li>Only created once per session (unless code changes)</li>
</ul></li>
<li>Example:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a><span class="at">@st.cache_resource</span></span>
<span id="cb27-2"><a></a><span class="kw">def</span> load_model():</span>
<span id="cb27-3"><a></a>    <span class="co"># expensive model loading</span></span>
<span id="cb27-4"><a></a>    ...</span>
<span id="cb27-5"><a></a>    <span class="cf">return</span> model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Be careful with <strong>non-deterministic functions</strong> (randomness, time)</li>
</ul>
</section>
<section id="deployment-checklist" class="slide level2">
<h2>Deployment checklist</h2>
<ul>
<li><strong>Code &amp; dependencies</strong>
<ul>
<li><code>requirements.txt</code> / <code>pyproject.toml</code></li>
<li><code>Procfile</code> (Heroku-style) ‚Üí <code>web: gunicorn app:app</code></li>
</ul></li>
<li><strong>Configuration</strong>
<ul>
<li>Config classes for dev/prod</li>
<li>Secrets via env vars (<code>SECRET_KEY</code>, DB URL, API keys)</li>
</ul></li>
<li><strong>Static &amp; media</strong>
<ul>
<li>Correct <code>static/</code> mapping</li>
<li>Where to store user uploads? (local disk vs cloud storage)</li>
</ul></li>
<li><strong>Observability</strong>
<ul>
<li>Logging, error tracking (Sentry, Rollbar, ‚Ä¶)</li>
<li>Health endpoint (<code>/health</code>) for monitoring</li>
</ul></li>
</ul>
</section>
<section id="wrap-up" class="slide level2">
<h2>Wrap-up</h2>
<ul>
<li>You now know how to:
<ul>
<li>Build <strong>Flask apps</strong> with routes, templates, forms, JSON APIs, sessions</li>
<li>Understand the <strong>request lifecycle</strong> and WSGI interface</li>
<li>Use <strong>Streamlit</strong> for fast data dashboards and prototypes</li>
<li>Deploy apps with production servers and handle basic security</li>
</ul></li>
<li>After this course you should:
<ul>
<li>Be able to build a <strong>small production-ready Flask app</strong></li>
<li>Prototype data apps quickly with Streamlit</li>
<li>Read Flask/Streamlit code from GitHub and understand it</li>
</ul></li>
</ul>
</section>
<section id="flask-blueprints" class="slide level2">
<h2>Flask: blueprints</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a><span class="co"># blueprints/admin/routes.py</span></span>
<span id="cb28-2"><a></a><span class="im">from</span> flask <span class="im">import</span> Blueprint</span>
<span id="cb28-3"><a></a></span>
<span id="cb28-4"><a></a>bp <span class="op">=</span> Blueprint(<span class="st">"admin"</span>, <span class="va">__name__</span>, url_prefix<span class="op">=</span><span class="st">"/admin"</span>)</span>
<span id="cb28-5"><a></a></span>
<span id="cb28-6"><a></a><span class="at">@bp.get</span>(<span class="st">"/users"</span>)</span>
<span id="cb28-7"><a></a><span class="kw">def</span> list_users():</span>
<span id="cb28-8"><a></a>    <span class="cf">return</span> <span class="st">"Admin: list of users"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a><span class="co"># app.py</span></span>
<span id="cb29-2"><a></a><span class="im">from</span> flask <span class="im">import</span> Flask</span>
<span id="cb29-3"><a></a><span class="im">from</span> blueprints.admin.routes <span class="im">import</span> bp <span class="im">as</span> admin_bp</span>
<span id="cb29-4"><a></a></span>
<span id="cb29-5"><a></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb29-6"><a></a>app.register_blueprint(admin_bp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Why blueprints?
<ul>
<li>Modularize routes by domain: <code>auth</code>, <code>admin</code>, <code>api</code>, <code>blog</code>, ‚Ä¶</li>
<li>Easier to maintain large apps, easier to reuse across projects</li>
</ul></li>
</ul>
</section>
<section id="streamlit-state" class="slide level2">
<h2>Streamlit: state</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb30-2"><a></a></span>
<span id="cb30-3"><a></a><span class="cf">if</span> <span class="st">"n"</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb30-4"><a></a>    st.session_state.n <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb30-5"><a></a></span>
<span id="cb30-6"><a></a>st.write(<span class="st">"n ="</span>, st.session_state.n)</span>
<span id="cb30-7"><a></a></span>
<span id="cb30-8"><a></a>col1, col2 <span class="op">=</span> st.columns(<span class="dv">2</span>)</span>
<span id="cb30-9"><a></a><span class="cf">if</span> col1.button(<span class="st">"Add 1"</span>):</span>
<span id="cb30-10"><a></a>    st.session_state.n <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-11"><a></a><span class="cf">if</span> col2.button(<span class="st">"Multiply by 2"</span>):</span>
<span id="cb30-12"><a></a>    st.session_state.n <span class="op">*=</span> <span class="dv">2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Use session state to maintain values across reruns</li>
<li>Useful for multi-step workflows, calculators, and interactive applications</li>
</ul>
</section>
<section id="deployment-gotchas" class="slide level2">
<h2>Deployment gotchas</h2>
<ul>
<li><strong>Timeouts</strong>
<ul>
<li>Long computations ‚Üí use background jobs / Celery / caching</li>
</ul></li>
<li><strong>Static files</strong>
<ul>
<li>Make sure your reverse proxy serves <code>/static</code> efficiently</li>
</ul></li>
<li><strong>CORS</strong>
<ul>
<li>If you serve an API used by JS in another domain</li>
<li>Use <code>flask-cors</code> or manual headers</li>
</ul></li>
<li><strong>Debug mode</strong>
<ul>
<li>Never run <code>debug=True</code> in production</li>
<li>Debugger gives code execution if misused</li>
</ul></li>
</ul>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Intro to VBA and Python</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>