<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-a6e161b2431e1f94a14e0f5d32135a3c.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <meta name="author" content="Juan F. Imbet">
  <title>Introduction to VBA and Python – VBA Session 1 — Introduction to VBA</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="../../styles.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <!-- Minimal TikZJax + MathJax loader for Quarto/Reveal.js -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tikzjax@0.1.6/tikzjax.css">

  <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/tikzjax@0.1.6/tikzjax.js"></script>

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">VBA Session 1 — Introduction to VBA</h1>
  <p class="subtitle">Macros, the VBE, and cross‑platform basics (Win/Mac)</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Juan F. Imbet 
</div>
        <p class="quarto-title-affiliation">
            Paris Dauphine University-PSL
          </p>
    </div>
</div>

</section>
<section class="slide level1">

<h2 id="welcome">Welcome</h2>
<ul>
<li>Course: Intro to VBA and Python (10&nbsp;sessions ×&nbsp;~3&nbsp;h)</li>
<li>Today: General Introduction</li>
<li>Goal: Build confidence to automate simple tasks in Excel using VBA</li>
</ul>
<h2 id="information">Information</h2>
<ul>
<li>Juan F. Imbet, Assistant Professor of Finance.</li>
<li>juan.imbet@dauphine.psl.eu</li>
<li>Office: P606</li>
<li>Office hours by appointment</li>
</ul>
</section>
<section class="slide level1">

<h2 id="bit-about-me">Bit about me</h2>
<ul>
<li>Engineering background, PhD in Finance (Pompeu Fabra University)</li>
<li>Research in Asset Pricing, Corporate Finance, Asset Management, and Computational Finance.</li>
<li>Teaching in Finance Theory, Programming, and Artificial Intelligence.</li>
<li>Consulting Private Equity Firms in implementing AI enhanced investment processes.</li>
</ul>
<h2 id="grading">Grading</h2>
<ul>
<li>Group Project 40% (topic joint with Aymeric Kalife’s class, 100% Python)</li>
<li>Final Exam 50% (less focus on exact syntax, more on concepts and problem solving)</li>
<li>Class Participation 10%</li>
</ul>
</section>
<section class="slide level1">

<h2 id="what-is-vba">What is VBA?</h2>
<ul>
<li>Visual Basic for Applications (VBA) is a programming language embedded inside Office apps (Excel, Word, PowerPoint, Access).</li>
<li>Runs inside the host application process (Excel), giving access to its Object Model: e.g.&nbsp;<code>Application → Workbooks → Worksheets → Range</code>.</li>
<li>Great for automating repetitive tasks, building custom functions and UI (forms, buttons), and integrating with files and data.</li>
<li>Cross‑platform note: VBA exists on Windows and Mac, but some integrations are Windows‑only. Companies use VBA almost exclusively on Windows.</li>
<li>Mac users can still run most VBA code.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="how-vba-relates-to-windows-vs-mac">How VBA relates to Windows vs&nbsp;Mac</h2>
<ul>
<li><strong>Windows:</strong> Excel exposes rich automation via COM/ActiveX; VBA can call Windows APIs and Office libraries broadly.</li>
<li>COM/ActiveX is a Windows feature that enables inter-application communication and advanced integrations.</li>
<li><strong>Mac:</strong> Same VBA language and Excel Object Model for most tasks; no COM/ActiveX, some features differ (File dialogs, Add‑ins, some APIs).</li>
<li><strong>Bitness matters on Windows</strong> (32/64‑bit Office).</li>
</ul>
<h2 id="why-learn-vba-in-2025">Why learn VBA in&nbsp;2025?</h2>
<ul>
<li>Excel remains the lingua franca of business.</li>
<li>Quick wins: automate reports, cleanup, formatting.</li>
<li>Bridges to other tools (Power&nbsp;Query, Python via xlwings, etc.).</li>
</ul>
<h2 id="disadvantages-of-vba">Disadvantages of VBA</h2>
<ul>
<li>Old language (from 1993); lacks modern features (e.g., no classes, limited error handling).</li>
<li>Not easy to debug or test.</li>
<li>Grammar is not the most friendly.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="macro-security-mindset">Macro security mindset</h2>
<ul>
<li>A Macro is the common name for some VBA code embedded in an Office document.</li>
<li>Macros can run code; treat files like executables.</li>
<li>Only enable content from trusted sources.</li>
<li>Use signed macros in corporate environments.</li>
<li>A signed macro is one that has been digitally signed with a certificate to verify its authenticity.</li>
</ul>
<p><strong>Windows (Trust&nbsp;Center):</strong> File&nbsp;→ Options&nbsp;→ Trust&nbsp;Center&nbsp;→ Trust&nbsp;Center&nbsp;Settings&nbsp;→ Macro&nbsp;Settings<br>
Recommended for learning: “Disable all macros with notification” + add a Trusted Location for your course folder.<br>
Consider enabling Protected View for files from the internet; unblock via file Properties&nbsp;→ Unblock.</p>
<p><strong>Mac (Trust&nbsp;Center):</strong> Excel&nbsp;→ Preferences&nbsp;→ Security&nbsp;&amp;&nbsp;Privacy<br>
Similar options: enable with notification; manage access to Visual Basic project if prompted.</p>
</section>
<section class="slide level1">

<h2 id="enable-developer-tab-windows">Enable Developer tab (Windows)</h2>
<ol type="1">
<li>File&nbsp;→ <strong>Options</strong>&nbsp;→ <strong>Customize&nbsp;Ribbon</strong></li>
<li>Under <strong>Main&nbsp;Tabs</strong>, check <strong>Developer</strong> and click <strong>OK</strong></li>
</ol>
<h2 id="enable-developer-tab-mac">Enable Developer tab (Mac)</h2>
<ol type="1">
<li>Excel&nbsp;→ <strong>Preferences</strong>&nbsp;→ <strong>Ribbon&nbsp;&amp;&nbsp;Toolbar</strong></li>
<li>Select <strong>Main&nbsp;Tabs</strong> and check <strong>Developer</strong></li>
<li>Click <strong>Save</strong>; the Developer tab appears</li>
</ol>
</section>
<section class="slide level1">

<h2 id="excel-ui-tour-winmac">Excel UI tour (Win/Mac)</h2>
<ul>
<li>Windows screenshot: Excel workbook with the Ribbon showing the Developer tab</li>
<li>Mac screenshot: Excel for Mac with Developer tab visible</li>
<li>Callouts: Record Macro button, Visual Basic button, Macros list</li>
</ul>
<div class="columns">
<div class="column">
<p><img data-src="https://upload.wikimedia.org/wikipedia/en/a/a8/Excel_2010.png" style="width:100.0%" data-fig-cap="Excel (Windows) — UI overview. Image: Microsoft product screenshot via Wikipedia. Used with permission from Microsoft (no modifications except resizing)." alt="Excel for Windows UI"></p>
</div><div class="column">
<p><img data-src="https://upload.wikimedia.org/wikipedia/en/a/ab/Excel_for_Mac_screenshot.png" style="width:100.0%" data-fig-cap="Excel (Mac) — UI overview. Image: Microsoft product screenshot via Wikipedia. Used with permission from Microsoft (no modifications except resizing)." alt="Excel for Mac UI"></p>
</div></div>
</section>
<section class="slide level1">

<h2 id="recording-a-macro-winmac">Recording a macro (Win/Mac)</h2>
<div class="columns">
<div class="column">
<p>Windows</p>
<ul>
<li>Developer&nbsp;→ Record Macro</li>
<li>Name, choose storage (This Workbook/Personal)</li>
<li>Do actions&nbsp;→ Stop&nbsp;→ inspect in VBE</li>
<li>Use “Use Relative References” for relative actions</li>
<li>Naming: start with a letter; verbs like <code>FormatHeader</code></li>
<li>Quick edit: Developer&nbsp;→ Macros&nbsp;→ Edit</li>
</ul>
</div><div class="column">
<p>Mac</p>
<ul>
<li>Developer&nbsp;→ Record Macro (similar flow)</li>
<li>Some shortcuts/dialogs differ slightly</li>
<li>Relative References also available</li>
<li>Prefer shape/button over keyboard shortcut (conflicts)</li>
<li>Storage mirrors Windows; Personal Macro Workbook exists</li>
</ul>
</div></div>
<h2 id="relative-references">Relative References</h2>
<ul>
<li>Relative References toggle (Windows/Mac) controls whether recorded actions use absolute cell references (e.g., <code>Range("A1")</code>) or relative to the active cell (e.g., <code>ActiveCell.Offset(0, 0)</code>).</li>
<li>Use the <code>Use Relative References</code> button on the Developer tab before starting to record.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="the-visual-basic-editor-vbe">The Visual Basic Editor (VBE)</h2>
<ul>
<li>Open with Alt+F11 (Windows) or Option+F11 (Mac)</li>
<li>Project Explorer, Properties Window, Code Pane</li>
<li>Modules vs ThisWorkbook vs Sheet objects</li>
<li>Insert a Module: VBE&nbsp;→ Insert&nbsp;→ Module (stores your <code>Sub</code> procedures)</li>
<li>Run code: press <code>F5</code> in VBE, or assign to a shape/button on the sheet</li>
</ul>
<h2 id="opening-the-vbe-stepbystep">Opening the VBE (step‑by‑step)</h2>
<ul>
<li>Windows: Use <code>Alt+F11</code>, or Ribbon → Developer → Visual Basic</li>
<li>Mac: Use <code>Option+F11</code>, or Ribbon → Developer → Visual Basic</li>
<li>Verify the Project Explorer (left) and Properties (bottom‑left); if hidden: View → Project Explorer, View → Properties Window</li>
<li>Use View menu to show/hide panes if your layout differs.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="hello-world-vba">Hello, world (VBA)</h2>
<ul>
<li>Macros start with a <code>Sub</code> procedure, and end with <code>End Sub</code>.</li>
<li>VBA has reserved words (e.g., <code>Sub</code>, <code>Dim</code>, <code>If</code>, <code>Then</code>, <code>End</code>); case-insensitive but prefer standard casing.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb1-1"><a></a> <span class="kw">Sub </span>HelloWorld()</span>
<span id="cb1-2"><a></a>     MsgBox <span class="st">"Hello from VBA!"</span></span>
<span id="cb1-3"><a></a> <span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>How to run it: place cursor inside <code>HelloWorld</code> and press <code>F5</code> (or click Run ▶)</li>
<li>Assign to a button: Insert → Shapes → pick a shape → right‑click → Assign Macro → choose <code>HelloWorld</code></li>
</ul>
</section>
<section class="slide level1">

<h2 id="procedures-variables-and-types">Procedures, variables, and types</h2>
<div class="columns">
<div class="column">
<p>Sub procedures and variables</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb2-1"><a></a><span class="kw">Sub </span>MyTask()</span>
<span id="cb2-2"><a></a>    <span class="co">' your steps here</span></span>
<span id="cb2-3"><a></a><span class="kw">End Sub</span></span>
<span id="cb2-4"><a></a></span>
<span id="cb2-5"><a></a><span class="kw">Sub </span>Boxes()</span>
<span id="cb2-6"><a></a>    <span class="kw">Dim</span> total <span class="kw">As</span> <span class="dt">Long</span> <span class="co">' variable declaration</span></span>
<span id="cb2-7"><a></a>    total = 42</span>
<span id="cb2-8"><a></a>    MsgBox total</span>
<span id="cb2-9"><a></a><span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Sub = a routine you can run; lives in a Module</li>
<li><code>Dim name As Type</code> declares storage</li>
</ul>
</div><div class="column">
<p>Types and Option Explicit</p>
<ul>
<li>Common types: <code>Integer</code>, <code>Long</code>, <code>Double</code>, <code>String</code>, <code>Boolean</code>, <code>Date</code></li>
<li><code>Variant</code> can hold anything (flexible but slower)</li>
<li>Prefer explicit types for clarity and speed</li>
<li>Not all types are available on Mac.</li>
<li>The <code>Option Explicit</code> statement forces variable declaration, reducing typos and bugs.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb3-1"><a></a><span class="kw">Option</span> <span class="kw">Explicit</span> <span class="co">' require declarations</span></span>
<span id="cb3-2"><a></a><span class="kw">Sub </span>Safer()</span>
<span id="cb3-3"><a></a>    <span class="kw">Dim</span> count <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb3-4"><a></a>    count = 10</span>
<span id="cb3-5"><a></a>    MsgBox count</span>
<span id="cb3-6"><a></a><span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>Option Explicit</code> → fewer typos, clearer code</li>
</ul>
</div></div>
</section>
<section class="slide level1">

<h2 id="scope-and-lifetime">Scope and lifetime</h2>
<ul>
<li>What variables are visible where, and how long they last.</li>
<li><code>Public</code> vs <code>Private</code>: controls visibility across modules</li>
<li><code>Public</code> = visible everywhere; <code>Private</code> = only inside the module</li>
<li><code>Const</code> for constants, variables that are not meant to change.</li>
<li>Constants are stored more efficiently in memory since their values do not change.</li>
<li><code>Sub</code> procedures can also be declared as <code>Public</code> or <code>Private</code>.</li>
<li>If no declaration is given, <code>Sub</code> procedures are <code>Public</code> by default.</li>
<li><code>Enum</code> for named integer constants.</li>
<li>Defining variables outside any procedure makes them module-level (retain value while module is loaded).</li>
</ul>
</section>
<section class="slide level1">

<h2 id="example">Example</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb4-1"><a></a><span class="kw">Option</span> <span class="kw">Explicit</span></span>
<span id="cb4-2"><a></a></span>
<span id="cb4-3"><a></a><span class="kw">Public</span> <span class="kw">Const</span> VAT <span class="kw">As</span> <span class="dt">Double</span> = 0.20 <span class="co">' project-wide constant (in a standard module)</span></span>
<span id="cb4-4"><a></a><span class="kw">Private</span> totalRuns <span class="kw">As</span> <span class="dt">Long</span>          <span class="co">' module-level state</span></span>
<span id="cb4-5"><a></a></span>
<span id="cb4-6"><a></a><span class="kw">Public</span> <span class="kw">Sub </span>RunTask()</span>
<span id="cb4-7"><a></a>    totalRuns = totalRuns + 1</span>
<span id="cb4-8"><a></a>    <span class="kw">Dim</span> localMsg <span class="kw">As</span> <span class="dt">String</span> <span class="co">' procedure scope</span></span>
<span id="cb4-9"><a></a>    localMsg = <span class="st">"Run #"</span> &amp; totalRuns</span>
<span id="cb4-10"><a></a>    Debug.Print localMsg</span>
<span id="cb4-11"><a></a><span class="kw">End Sub</span></span>
<span id="cb4-12"><a></a></span>
<span id="cb4-13"><a></a><span class="kw">Private</span> <span class="kw">Function </span>Hidden() <span class="kw">As</span> <span class="dt">Boolean</span> <span class="co">' not visible outside module</span></span>
<span id="cb4-14"><a></a>    Hidden = <span class="kw">True</span></span>
<span id="cb4-15"><a></a><span class="kw">End Function</span></span>
<span id="cb4-16"><a></a></span>
<span id="cb4-17"><a></a><span class="kw">Public</span> <span class="kw">Sub </span>Remember()</span>
<span id="cb4-18"><a></a>    Static last <span class="kw">As</span> <span class="dt">Long</span> <span class="co">' retains value across calls</span></span>
<span id="cb4-19"><a></a>    last = last + 1</span>
<span id="cb4-20"><a></a>    Debug.Print last</span>
<span id="cb4-21"><a></a><span class="kw">End Sub</span></span>
<span id="cb4-22"><a></a></span>
<span id="cb4-23"><a></a><span class="kw">Public</span> <span class="kw">Enum </span>Status</span>
<span id="cb4-24"><a></a>    stPending = 0</span>
<span id="cb4-25"><a></a>    stDone = 1</span>
<span id="cb4-26"><a></a>    stError = 2</span>
<span id="cb4-27"><a></a><span class="kw">End Enum</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section class="slide level1">

<h2 id="debugging">Debugging</h2>
<ul>
<li>Large programs rarely run perfectly the first time.</li>
<li>Understanding the values that variables take at different points in execution is key to finding and fixing bugs.</li>
<li>To write something in the debugging output window, use <code>Debug.Print</code>.</li>
<li>This output can be viewed in the Immediate Window (Ctrl+G in Windows or Cmd+G in Mac).</li>
</ul>
<h2 id="referencing-cells">Referencing cells</h2>
<ul>
<li>VBA can access and manipulate Excel cells directly.</li>
<li>Absolute reference example uses the <code>Range</code> object.</li>
<li>Relative reference example uses <code>ActiveCell</code> and <code>Offset</code>.</li>
<li><code>ActiveCell</code> is the currently selected cell in the active worksheet.</li>
<li><code>Offset</code> is used to refer to a cell that is a specific number of rows and columns away from another cell.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb5-1"><a></a><span class="kw">Sub </span>SetA1()</span>
<span id="cb5-2"><a></a>    Range(<span class="st">"A1"</span>).Value = <span class="st">"Hi"</span></span>
<span id="cb5-3"><a></a><span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Qualify with Worksheets(“Sheet1”).Range(“A1”) to be precise</li>
<li>Qualify fully when multiple workbooks: <code>Workbooks("Book1.xlsx").Worksheets("Sheet1").Range("A1")</code></li>
<li><code>Cells(row, col)</code> uses numbers: <code>Cells(1, 1)</code> is A1; can combine: <code>Range(Cells(1,1), Cells(10,2))</code></li>
<li>Useful for loops.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="selecting-vs-directly-writing">Selecting vs directly writing</h2>
<ul>
<li>Avoid Select/Activate when possible; write directly</li>
</ul>
<p>Do this</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb6-1"><a></a>Worksheets(<span class="st">"Sheet1"</span>).Range(<span class="st">"A1"</span>).Value = <span class="st">"Direct write"</span></span>
<span id="cb6-2"><a></a>With Worksheets(<span class="st">"Sheet1"</span>)</span>
<span id="cb6-3"><a></a>    .Range(<span class="st">"B1"</span>).Value = <span class="st">"With block"</span></span>
<span id="cb6-4"><a></a>    .Cells(2, 1).Value = 123</span>
<span id="cb6-5"><a></a>End With</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Not this</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb7-1"><a></a>Worksheets(<span class="st">"Sheet1"</span>).Select</span>
<span id="cb7-2"><a></a>Range(<span class="st">"A1"</span>).Select</span>
<span id="cb7-3"><a></a>Selection.Value = <span class="st">"Indirect write"</span></span>
<span id="cb7-4"><a></a>Range(<span class="st">"B1"</span>).Select</span>
<span id="cb7-5"><a></a>ActiveCell.Value = <span class="st">"Indirect with ActiveCell"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section class="slide level1">

<h2 id="conditionals">Conditionals</h2>
<div class="columns">
<div class="column">
<p>If…Then</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb8-1"><a></a><span class="kw">If </span>Range(<span class="st">"A1"</span>).Value &gt; 0 <span class="kw">Then</span></span>
<span id="cb8-2"><a></a>    MsgBox <span class="st">"Positive"</span></span>
<span id="cb8-3"><a></a><span class="kw">Else</span></span>
<span id="cb8-4"><a></a>    MsgBox <span class="st">"Non‑positive"</span></span>
<span id="cb8-5"><a></a><span class="kw">End If</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Great for simple conditions and ranges</li>
</ul>
</div><div class="column">
<p>Select Case</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb9-1"><a></a><span class="kw">Select Case Range("B1").Value</span></span>
<span id="cb9-2"><a></a>    Case <span class="st">"A"</span>, <span class="st">"B"</span>: MsgBox <span class="st">"Group 1"</span></span>
<span id="cb9-3"><a></a>    Case <span class="st">"C"</span>: MsgBox <span class="st">"Group 2"</span></span>
<span id="cb9-4"><a></a>    Case <span class="kw">Else</span>: MsgBox <span class="st">"Other"</span></span>
<span id="cb9-5"><a></a><span class="kw">End Select</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Cleaner than nested Ifs for discrete categories</li>
</ul>
</div></div>
</section>
<section class="slide level1">

<h2 id="loops-do-it-repeatedly">Loops: Do it repeatedly</h2>
<ul>
<li>You need to define the variable that controls the loop.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb10-1"><a></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb10-2"><a></a><span class="kw">For </span>i = 1 <span class="kw">To</span> 10</span>
<span id="cb10-3"><a></a>    Cells(i, 1).Value = i</span>
<span id="cb10-4"><a></a><span class="kw">Next </span>i</span>
<span id="cb10-5"><a></a></span>
<span id="cb10-6"><a></a><span class="kw">Dim</span> c <span class="kw">As</span> Range</span>
<span id="cb10-7"><a></a><span class="kw">For </span>Each c In Range(<span class="st">"A1:A10"</span>)</span>
<span id="cb10-8"><a></a>    c.Value = c.Value &amp; <span class="st">"!"</span> <span class="co">' The &amp; concatenates strings</span></span>
<span id="cb10-9"><a></a><span class="kw">Next </span>c</span>
<span id="cb10-10"><a></a></span>
<span id="cb10-11"><a></a><span class="kw">Dim</span> k <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb10-12"><a></a>k = 1</span>
<span id="cb10-13"><a></a><span class="kw">Do While </span>k &lt;= 10</span>
<span id="cb10-14"><a></a>    Cells(k, 2).Value = k * 2</span>
<span id="cb10-15"><a></a>    k = k + 1</span>
<span id="cb10-16"><a></a><span class="kw">Loop</span></span>
<span id="cb10-17"><a></a></span>
<span id="cb10-18"><a></a><span class="kw">Dim</span> tries <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb10-19"><a></a>tries = 0</span>
<span id="cb10-20"><a></a><span class="kw">Do</span></span>
<span id="cb10-21"><a></a>    tries = tries + 1</span>
<span id="cb10-22"><a></a><span class="kw">Loop </span>Until tries &gt;= 10</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>For ... Next</code>: use a counter variable for numeric ranges</li>
<li><code>For Each ... Next</code>: iterate items in a collection (<code>Worksheets</code>, <code>Shapes</code>, or cells in a <code>Range</code>)</li>
<li><code>Do While</code>/<code>Do Until</code>: loop while/until a condition is satisfied (see next slide)</li>
</ul>
</section>
<section class="slide level1">

<h2 id="debugging-essentials">Debugging essentials</h2>
<ul>
<li>Breakpoints (click left margin), the code execution will pause there.</li>
<li>Step Into <code>F8</code>, Step Over <code>Shift+F8</code>, Step Out <code>Ctrl+Shift+F8</code></li>
<li>Immediate window <code>Ctrl+G</code>: evaluate (<code>? Range("A1").Value</code>) or call procedures</li>
<li><code>Debug.Print</code> for tracing; <code>Stop</code> statement to break programmatically</li>
</ul>
<h2 id="how-to-inspect-variables-live">How to inspect variables live</h2>
<ul>
<li>Use the Locals window (View → Locals Window) to see all local variables and their current values when paused at a breakpoint.</li>
<li>Not all variables may have their values shown in the Locals window, especially if they are complex objects or if the code is not currently within the scope where the variable is defined.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb11-1"><a></a><span class="kw">Sub </span>Trace()</span>
<span id="cb11-2"><a></a>   <span class="kw">Dim</span> c <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb11-3"><a></a>    <span class="kw">For </span>c = 1 <span class="kw">To</span> 10</span>
<span id="cb11-4"><a></a>        c = c + 1</span>
<span id="cb11-5"><a></a>    <span class="kw">Next </span>c</span>
<span id="cb11-6"><a></a><span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Tip: Reproduce fast; isolate into small test Subs; comment out non-essential code while debugging</li>
</ul>
</section>
<section class="slide level1">

<h2 id="do-while-do-until">Do While / Do Until</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb12-1"><a></a><span class="kw">Dim</span> r <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb12-2"><a></a>r = 1</span>
<span id="cb12-3"><a></a><span class="kw">Do While </span>Cells(r, 1).Value &lt;&gt; <span class="st">""</span></span>
<span id="cb12-4"><a></a>    Cells(r, 2).Value = Len(Cells(r, 1).Value)</span>
<span id="cb12-5"><a></a>    r = r + 1</span>
<span id="cb12-6"><a></a><span class="kw">Loop</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>Do While condition ... Loop</code>: runs while condition is True</li>
<li><code>Do Until condition ... Loop</code>: runs until condition becomes True</li>
<li>Prefer guard rails: increment counters, add max-iteration safety to avoid infinite loops</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb13-1"><a></a><span class="kw">Dim</span> tries <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb13-2"><a></a>tries = 0</span>
<span id="cb13-3"><a></a><span class="kw">Do</span></span>
<span id="cb13-4"><a></a>    tries = tries + 1</span>
<span id="cb13-5"><a></a>    <span class="kw">If </span>tries &gt; 1000 <span class="kw">Then</span> Exit <span class="kw">Do </span><span class="co">' safety</span></span>
<span id="cb13-6"><a></a>    <span class="co">' ... work ...</span></span>
<span id="cb13-7"><a></a><span class="kw">Loop </span>Until Application.CountA(Range(<span class="st">"A1:A10"</span>)) = 10</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Tip: Choose <code>For</code> when you know counts, <code>For Each</code> for collections, <code>Do While/Until</code> for condition-driven loops</li>
</ul>
</section>
<section class="slide level1">

<h2 id="inputbox-and-msgbox">InputBox and MsgBox</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb14-1"><a></a><span class="kw">Dim</span> name <span class="kw">As</span> <span class="dt">String</span></span>
<span id="cb14-2"><a></a>name = InputBox(<span class="st">"Your name?"</span>)</span>
<span id="cb14-3"><a></a>MsgBox <span class="st">"Hi "</span> &amp; name</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Simple UI for quick interactions</li>
</ul>
<p>Advanced: prompt for a Range safely</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb15-1"><a></a><span class="kw">Sub </span>PickRange()</span>
<span id="cb15-2"><a></a>    <span class="kw">Dim</span> rng <span class="kw">As</span> Range</span>
<span id="cb15-3"><a></a>    <span class="kw">On</span> <span class="kw">Error</span> <span class="kw">Resume</span> <span class="kw">Next</span></span>
<span id="cb15-4"><a></a>    <span class="kw">Set </span>rng = Application.InputBox(<span class="st">"Select a range"</span>, Type:=8)</span>
<span id="cb15-5"><a></a>    <span class="kw">On</span> <span class="kw">Error</span> <span class="kw">GoTo</span> 0</span>
<span id="cb15-6"><a></a>    <span class="kw">If </span>rng Is <span class="kw">Nothing</span> <span class="kw">Then</span></span>
<span id="cb15-7"><a></a>        MsgBox <span class="st">"No selection"</span></span>
<span id="cb15-8"><a></a>    <span class="kw">Else</span></span>
<span id="cb15-9"><a></a>        MsgBox <span class="st">"You picked "</span> &amp; rng.Address</span>
<span id="cb15-10"><a></a>    <span class="kw">End If</span></span>
<span id="cb15-11"><a></a><span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section class="slide level1">

<h2 id="arrays-static-vs-dynamic">Arrays (static vs dynamic)</h2>
<ul>
<li>An array is a collection of values indexed by number.</li>
<li><code>Static</code> arrays have fixed size; <code>Dynamic</code> arrays can be resized with <code>ReDim</code>.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb16-1"><a></a><span class="co">' Static array (fixed size)</span></span>
<span id="cb16-2"><a></a><span class="kw">Dim</span> a(1 <span class="kw">To</span> 5) <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb16-3"><a></a>a(1) = 10</span>
<span id="cb16-4"><a></a></span>
<span id="cb16-5"><a></a><span class="co">' Dynamic array (resize later)</span></span>
<span id="cb16-6"><a></a><span class="kw">Dim</span> b() <span class="kw">As</span> <span class="dt">Double</span></span>
<span id="cb16-7"><a></a><span class="kw">ReDim</span> b(1 <span class="kw">To</span> 3)</span>
<span id="cb16-8"><a></a>b(3) = 1.23</span>
<span id="cb16-9"><a></a><span class="kw">ReDim</span> Preserve b(1 <span class="kw">To</span> 5) <span class="co">' keep existing values</span></span>
<span id="cb16-10"><a></a><span class="kw">ReDim</span> b(1 <span class="kw">To</span> 2) <span class="co">' loses existing values</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Static arrays: fastest, but fixed bounds</li>
<li>Dynamic arrays: <code>ReDim</code> to set size; <code>ReDim Preserve</code> to keep values.</li>
<li>Bounds defaults: if unspecified, VBA uses zero-based indexing; prefer explicit <code>1 To N</code> for clarity</li>
<li>Many programming languages use zero-based indexing; VBA defaults to zero-based if no bounds are specified, but using <code>1 To N</code> is clearer for Excel users.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="collections-and-dictionary">Collections and Dictionary</h2>
<ul>
<li>Two main collection types: <code>Collection</code> (built-in) and <code>Scripting.Dictionary</code> (Windows).</li>
<li>Collections have no fixed size; Dictionaries map keys to values.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb17-1"><a></a><span class="co">' Collection (built-in)</span></span>
<span id="cb17-2"><a></a><span class="kw">Dim</span> coll <span class="kw">As</span> <span class="kw">New</span> Collection</span>
<span id="cb17-3"><a></a>coll.Add <span class="st">"Alice"</span></span>
<span id="cb17-4"><a></a>coll.Add <span class="st">"Bob"</span></span>
<span id="cb17-5"><a></a><span class="kw">Dim</span> item <span class="kw">As</span> Variant</span>
<span id="cb17-6"><a></a><span class="kw">For </span>Each item In coll</span>
<span id="cb17-7"><a></a>    Debug.Print item</span>
<span id="cb17-8"><a></a><span class="kw">Next</span></span>
<span id="cb17-9"><a></a></span>
<span id="cb17-10"><a></a><span class="co">' Scripting.Dictionary (Windows)</span></span>
<span id="cb17-11"><a></a><span class="kw">Dim</span> dict <span class="kw">As</span> <span class="dt">Object</span></span>
<span id="cb17-12"><a></a><span class="kw">Set </span>dict = CreateObject(<span class="st">"Scripting.Dictionary"</span>)</span>
<span id="cb17-13"><a></a>dict(<span class="st">"FR"</span>) = <span class="st">"France"</span></span>
<span id="cb17-14"><a></a>dict(<span class="st">"ES"</span>) = <span class="st">"Spain"</span></span>
<span id="cb17-15"><a></a><span class="kw">If </span>dict.Exists(<span class="st">"FR"</span>) <span class="kw">Then</span> Debug.Print dict(<span class="st">"FR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Collection: ordered, allows duplicates, 1-based indexing via <code>Item</code></li>
<li>Dictionary: key→value map, fast lookup; on Mac, available via AppleScript support but often easiest to simulate with <code>Collection</code> or use array lookups</li>
<li>Tip: For portability, prefer <code>Collection</code> or arrays unless you really need keyed lookup</li>
<li><code>Dim</code> vs <code>Set', Dim declares a variable;</code>Set` assigns an object reference.</li>
<li>An object reference points to an instance of an object (like a <code>Collection</code> or <code>Dictionary</code>).</li>
</ul>
</section>
<section class="slide level1">

<h2 id="object-references">Object references</h2>
<ul>
<li>If you modify an object through one reference, the changes are reflected when accessing it through another reference.</li>
</ul>
<p>Example</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb18-1"><a></a><span class="kw">Dim</span> coll1 <span class="kw">As</span> <span class="kw">New</span> Collection</span>
<span id="cb18-2"><a></a><span class="kw">Dim</span> coll2 <span class="kw">As</span> Collection</span>
<span id="cb18-3"><a></a><span class="kw">Set </span>coll2 = coll1 <span class="co">' coll2 now references the same Collection as coll1</span></span>
<span id="cb18-4"><a></a>coll1.Add <span class="st">"Item1"</span></span>
<span id="cb18-5"><a></a>Debug.Print coll2.Count <span class="co">' Outputs 1, as coll2 references the same Collection</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section class="slide level1">

<h2 id="subs-vs-functions-user-defined-functions---udfs">Subs vs Functions (User Defined Functions - UDFs)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb19-1"><a></a><span class="co">' Sub performs actions</span></span>
<span id="cb19-2"><a></a><span class="kw">Sub </span>ClearData()</span>
<span id="cb19-3"><a></a>    Worksheets(<span class="st">"Sheet1"</span>).Range(<span class="st">"A2:D1000"</span>).ClearContents</span>
<span id="cb19-4"><a></a><span class="kw">End Sub</span></span>
<span id="cb19-5"><a></a></span>
<span id="cb19-6"><a></a><span class="co">' Function returns a value (UDF) name the variable that captures the return value as the function name</span></span>
<span id="cb19-7"><a></a><span class="kw">Public</span> <span class="kw">Function </span>AddTax(amount <span class="kw">As</span> <span class="dt">Double</span>, rate <span class="kw">As</span> <span class="dt">Double</span>) <span class="kw">As</span> <span class="dt">Double</span></span>
<span id="cb19-8"><a></a>    AddTax = amount * (1 + rate)</span>
<span id="cb19-9"><a></a><span class="kw">End Function</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>Sub</code>: run from VBE, buttons, or macros dialog; can modify workbook state</li>
<li><code>Function</code>: returns a value; can be used in worksheet cells as a UDF</li>
<li>UDF caveats: should be pure (function of inputs only); avoid side effects (changing sheets)</li>
<li>For security UDFs are not allowed to modify the Excel environment (e.g., changing cell values, formatting, or interacting with other applications). They should only compute and return values based on their input parameters.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="the-workbook-worksheet-and-worksheetfunction-objects">The <code>Workbook</code>, <code>Worksheet</code> and <code>WorksheetFunction</code> objects</h2>
<ul>
<li>Each workbook and worksheet has its own code module (ThisWorkbook, Sheet1, etc.)</li>
<li>They allow access to events (open, close, change, etc.)</li>
<li>They also allow access to standard excel formulas.</li>
<li>Use <code>ThisWorkbook</code> to refer to the workbook containing the code.</li>
<li>Some common events:
<ul>
<li><code>Workbook_Open</code>: runs when the workbook opens</li>
<li><code>Workbook_BeforeClose</code>: runs before the workbook closes</li>
<li><code>Worksheet_Change</code>: runs when a cell value changes in that sheet</li>
</ul></li>
<li>This is the main reason why Office applications ask to enable macros when opening files with VBA code.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb20-1"><a></a><span class="kw">Private</span> <span class="kw">Sub </span>Workbook_Open()</span>
<span id="cb20-2"><a></a>    MsgBox <span class="st">"Welcome!"</span></span>
<span id="cb20-3"><a></a><span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section class="slide level1">

<h2 id="access-to-standard-excel-formulas">Access to standard Excel formulas</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb21-1"><a></a><span class="kw">Sub </span>UseExcelFunction()</span>
<span id="cb21-2"><a></a>    <span class="kw">Dim</span> result <span class="kw">As</span> <span class="dt">Double</span></span>
<span id="cb21-3"><a></a>    result = Application.WorksheetFunction.Sum(Range(<span class="st">"A1:A10"</span>))</span>
<span id="cb21-4"><a></a>    MsgBox <span class="st">"Sum is "</span> &amp; result</span>
<span id="cb21-5"><a></a><span class="kw">End Sub</span></span>
<span id="cb21-6"><a></a>---</span>
<span id="cb21-7"><a></a></span>
<span id="cb21-8"><a></a>## Win vs Mac differences (overview)</span>
<span id="cb21-9"><a></a></span>
<span id="cb21-10"><a></a>- Shortcuts (Alt vs <span class="kw">Option</span>), some dialogs differ</span>
<span id="cb21-11"><a></a>- File system paths differ</span>
<span id="cb21-12"><a></a>- Many <span class="dt">object</span> model calls are the same</span>
<span id="cb21-13"><a></a></span>
<span id="cb21-14"><a></a>Details that matter:</span>
<span id="cb21-15"><a></a>- Paths: Windows uses `C:\Users\...\file.xlsx`; Mac uses `/Users/you/file.xlsx`; combine with `Application.PathSeparator`</span>
<span id="cb21-16"><a></a>- File dialogs: `Application.FileDialog(msoFileDialogFilePicker)` works <span class="kw">on</span> both, but filters <span class="kw">and</span> <span class="kw">default</span> folders behave slightly differently</span>
<span id="cb21-17"><a></a>- API calls: Windows allows `Declare PtrSafe Function` <span class="kw">to</span> <span class="kw">call</span> Win32 APIs; Mac lacks Win32 — avoid OS API calls <span class="kw">for </span>portability</span>
<span id="cb21-18"><a></a>- Add‑ins: `.xlam` works both; COM add‑ins are Windows‑only</span>
<span id="cb21-19"><a></a></span>
<span id="cb21-20"><a></a>---</span>
<span id="cb21-21"><a></a></span>
<span id="cb21-22"><a></a>## <span class="kw">Error</span> handling basics</span>
<span id="cb21-23"><a></a></span>
<span id="cb21-24"><a></a>```vb</span>
<span id="cb21-25"><a></a><span class="kw">Sub </span>DoWork()</span>
<span id="cb21-26"><a></a>    <span class="kw">On</span> <span class="kw">Error</span> <span class="kw">GoTo</span> CleanUp <span class="co">' jump to CleanUp on error</span></span>
<span id="cb21-27"><a></a>    <span class="co">' ... risky code here ...</span></span>
<span id="cb21-28"><a></a></span>
<span id="cb21-29"><a></a>Done:</span>
<span id="cb21-30"><a></a>    <span class="co">' What to do when done</span></span>
<span id="cb21-31"><a></a>    <span class="kw">Exit Sub</span></span>
<span id="cb21-32"><a></a></span>
<span id="cb21-33"><a></a>CleanUp:</span>
<span id="cb21-34"><a></a>    MsgBox <span class="st">"Error "</span> &amp; Err.Number &amp; <span class="st">": "</span> &amp; Err.Description, vbExclamation, <span class="st">"DoWork"</span></span>
<span id="cb21-35"><a></a>    <span class="kw">Resume</span> Done</span>
<span id="cb21-36"><a></a><span class="kw">End Sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Start simple; add structure as you grow</li>
</ul>
</section>
<section class="slide level1">

<h2 id="variable-types">Variable Types</h2>
<ul>
<li><code>Integer</code>: -32,768 to 32,767 (2 bytes)</li>
<li><code>Long</code>: -2,147,483,648 to 2,147,483,647 (4 bytes)</li>
<li><code>Single</code>: Single-precision floating point (4 bytes)</li>
<li><code>Double</code>: Double-precision floating point (8 bytes)</li>
<li><code>String</code>: Text (up to ~2 billion characters)</li>
<li><code>Boolean</code>: True/False (2 bytes)</li>
<li><code>Date</code>: Dates and times (8 bytes)</li>
<li><code>Variant</code>: Can hold any type; default if no type specified (16 bytes + data)</li>
<li>Prefer explicit types for clarity and performance; <code>Variant</code> is flexible but slower and uses more memory</li>
<li>Not all types are available on Mac.</li>
</ul>
</section>
<section class="slide level1">

<h2 id="your-first-serious-program-exercise-in-class">Your first serious program (exercise in class)</h2>
<ul>
<li>For your first exercise you are going to estimate the value of <span class="math inline">\(\pi\)</span> using a Monte Carlo method.</li>
<li>Imagin e a square of side 2 (from -1 to 1 in both x and y) that contains a circle of radius 1.</li>
<li>The area of the square is 4, and the area of the circle is <span class="math inline">\(\pi\)</span>.</li>
<li>You are going to randomly generate points in the square, and count how many fall inside the circle as a fraction of the total points.</li>
<li>This fraction multiplied by 4 will give you an estimate of <span class="math inline">\(\pi\)</span>.</li>
</ul>
<p>Your task - Create a UDF <code>EstimatePi(n As Long) As Double</code> that takes the number of random points to generate as input, and returns the estimate of <span class="math inline">\(\pi\)</span>. - Use <code>x = Rnd</code> to generate random numbers between 0 and 1; scale it to -1 to 1. - Return the estimate. - Your function should be available in the worksheet as e.g.&nbsp;<code>=EstimatePi(10000)</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode numberSource vb number-lines code-with-copy"><code class="sourceCode monobasic"><span id="cb22-1"><a></a><span class="kw">Function </span>EstimatePi(n <span class="kw">As</span> <span class="dt">Long</span>) <span class="kw">As</span> <span class="dt">Double</span></span>
<span id="cb22-2"><a></a>    <span class="kw">Dim</span> inside <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb22-3"><a></a>    <span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Long</span></span>
<span id="cb22-4"><a></a>    <span class="kw">Dim</span> x <span class="kw">As</span> <span class="dt">Double</span>, y <span class="kw">As</span> <span class="dt">Double</span></span>
<span id="cb22-5"><a></a>    inside = 0</span>
<span id="cb22-6"><a></a>    <span class="co">'Randomize 'Optional Initialize random number generator</span></span>
<span id="cb22-7"><a></a>    <span class="kw">For </span>i = 1 <span class="kw">To</span> n</span>
<span id="cb22-8"><a></a>        x = Rnd * 2 - 1 <span class="co">' Random x in [-1, 1]</span></span>
<span id="cb22-9"><a></a>        y = Rnd * 2 - 1 <span class="co">' Random y in [-1, 1]</span></span>
<span id="cb22-10"><a></a>        <span class="kw">If </span>x * x + y * y &lt;= 1 <span class="kw">Then</span></span>
<span id="cb22-11"><a></a>            inside = inside + 1</span>
<span id="cb22-12"><a></a>        <span class="kw">End If</span></span>
<span id="cb22-13"><a></a>    <span class="kw">Next </span>i</span>
<span id="cb22-14"><a></a>    EstimatePi = (inside / n) * 4 <span class="co">' Estimate of pi</span></span>
<span id="cb22-15"><a></a><span class="kw">End Function</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>